# Garbage Collection

##  Определение

GC - это процесс освобождения места памяти, которое больше не используется. Сборщик муссора определяет объекты, находящиеся вне области видимисти, на которые больше нельзя ссылаться и освобождает память.

GC выполняется конкурентно с нашей программой.

## Алгоритм

В основе GC лежит "трехцветный алгоритм".  Основной принцип в разделение объектов в куче на три множества:
1. Черные - не имеют указатели на белые объекты
2. Серые - на них могут ссылаться белые объекты
3. Белые - имеют указатели на черный объекты

Корневые - это объекты к которым можно обращаться напрямую, например глобальные переменные, элементы в стеке и т.д.

Алгоритм:

1. Все объекты сначала белые
2. Идет перебор "корневых" объектов, помечаются как серые
3. Идет перебор серых объектов, проверяются ссылки на другие объекты и помечаются
4. Обход продолжается до тех пор, пока не будут перебраны все серые объекты
5. Все оставшиеся белые объекты считаются недостижимыми, их можно удалить.

Если объект серого множества становится не достижым, он будет обработан в следущем цикле сборки мусора.

## Мутатор

Мутатор - это приложение, работающее во время сборки муссора. Которое вызывает функцию барьера записи. Задача этой функции, чтобы черные объекты не указывали на белые. Эта функция выполняется всякий раз, когда изменяется указатели в куче. Если указатель достижым, его помечают в серый цвет

## Pacer

Paccer - следит за выделением памяти, когда размер кучи становится в 2 раза больше, запускается GC

## Совет

С большим количеством данных лучше использовать слайс, а не хэш-таблицу. Так-как GC работает быстрее со слайсами.